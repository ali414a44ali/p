from pyrogram import Client, filters, enums
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, ChatPermissions, Message, CallbackQuery
from pyrogram.enums import ChatMemberStatus, ChatType
import asyncio
import asyncio
from pyrogram import filters, enums, types
from pyrogram.errors import PeerIdInvalid, RPCError, FloodWait
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton

from VeGa import app
from datetime import datetime, timedelta
from VeGa import app
from config import OWNER_ID
import random
from random import choice
from pyrogram import Client, filters, enums
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, ChatPermissions, Message, CallbackQuery
from pyrogram.enums import ChatMemberStatus, ChatType
import asyncio
from datetime import datetime, timedelta
from VeGa import app
from config import OWNER_ID
from config import*
import random
from random import choice
from pyrogram import Client, filters
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup, CallbackQuery

from pyrogram import Client, filters
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup, CallbackQuery

from collections import defaultdict
import re
import requests
import asyncio
import glob
import os
import time
import requests
import random
import aiohttp
import wget
import yt_dlp
import traceback
from pyrogram.types import InputMediaAudio
import asyncio
import os
import re
from typing import Union

import yt_dlp
from yt_dlp import YoutubeDL
from pyrogram.enums import MessageEntityType
from pyrogram.types import Message
from youtubesearchpython.__future__ import VideosSearch

from VeGa.utils.database import is_on_off
from VeGa.utils.formatters import time_to_seconds
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from youtubesearchpython import SearchVideos
import requests
import wget
from config import *
import config
from config import OWNER_ID
from config import BANNED_USERS
from config import BANNED_USERS, OWNER_ID
from config import START_VIDS
from pyrogram import filters
from pyrogram import Client
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from VeGa import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGa import app
from random import  choice, randint
from pytube import Search
from pyrogram import Client, filters
from pyrogram.types import (InlineKeyboardButton,CallbackQuery,InlineKeyboardMarkup, Message)
from pyrogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton, InputMediaPhoto
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.errors import FloodWait, MessageNotModified
from pyrogram.types import Message
from youtube_search import YoutubeSearch
from youtubesearchpython import VideosSearch
from yt_dlp import YoutubeDL
from VeGa import app
import speech_recognition as sr
from pyrogram import Client, filters
from pydub import AudioSegment
from os import remove
import asyncio
import os
import time
import requests
import random
import aiohttp
from config import *
import config
from pyrogram import filters
from pyrogram import Client
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from VeGa import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGa import app
from telegraph import upload_file
from asyncio import gather
from random import  choice, randint
from pyrogram import Client, filters
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.types import CallbackQuery, InputMediaPhoto, InlineKeyboardMarkup, InlineKeyboardButton
from pySmartDL import SmartDL
from VeGa import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube)
from pyrogram.types import CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram import filters
import random
from pyrogram import Client

import requests
import yt_dlp
from youtube_search import YoutubeSearch

import asyncio
import config
import re
import os
import requests
from os import getenv
from pyrogram import Client, filters
from VeGa import app
from config import OWNER_ID
from pyrogram import filters, Client
from pyrogram import filters
from pyrogram import Client
from typing import Union
from aiohttp import ClientSession
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.enums import ChatMemberStatus, ParseMode
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from VeGa.misc import SUDOERS
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup, Message, ReplyKeyboardMarkup
from pyrogram.types import (InlineKeyboardButton,CallbackQuery,InlineKeyboardMarkup, Message)
from VeGa.utils.database import (set_cmode,get_assistant)
from pyrogram.types import (InlineKeyboardButton, ChatPermissions, InlineKeyboardMarkup, Message, User)
from datetime import datetime
from pyrogram import enums
from config import OWNER_ID
from pyrogram.errors import MessageNotModified


from pyrogram.types import CallbackQuery

from pyrogram.types import CallbackQuery, InputMediaPhoto, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from VeGa import app
from pyrogram.types import ChatPermissions, ChatPrivileges
from config import *
from pyrogram.enums import ChatMembersFilter
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup                           
import asyncio
from VeGa import Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app
from VeGa import app
import pyrogram
from VeGa.misc import SUDOERS
from emoji import emojize
from config import *
from pyrogram import filters
from config import OWNER_ID
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton, InputMediaPhoto
from pyrogram.enums import ParseMode
from VeGa import app
from VeGa.utils.database import is_on_off
from config import LOGGER_ID


#مكاتب كود قولي

import asyncio
import aiohttp

import os
import time
import requests
from config import START_VIDS
from pyrogram import filters
import random
from pyrogram.enums import ChatMembersFilter
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import ChatPermissions, ChatPrivileges
from config import*
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.enums import ChatMembersFilter
from pyrogram import enums
from pyrogram import Client
from pyrogram import enums
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup
from VeGa import (Apple, Resso, SoundCloud, Spotify, Telegram, YouTube, app)
from VeGa import app
from random import  choice, randint
from pyrogram import Client, filters
from pyrogram.types import Message
from gtts import gTTS
from telegraph import upload_file
from asyncio import gather
from pyrogram.errors import FloodWait
from pydub import AudioSegment
from playsound import playsound
from pyrogram import Client, filters
from gtts import gTTS
import re
from pyrogram import Client, filters
from pyrogram.enums import ChatMemberStatus
from pyrogram.types import Message
from cachetools import TTLCache
from VeGa.core.call import KIM
from VeGa.utils.database import get_assistant
from config import OWNER_ID
from VeGa.plugins.play.ADMANS import *


chat_locks = {}
id = {}  
user_messages = {}  
message_counts = {}  
amaerrof = []
welcome_messages = {}
welcome_locked = False
disabled_chats = []



# متغيرات الأقفال العامة
class ChatLocks:
    def __init__(self, chat_id):
        self.chat_id = chat_id
        self.chat_locked = False
        self.mention_locked = False
        self.video_locked = False
        self.link_locked = False
        self.sticker_locked = False
        self.forward_locked = False
        self.photo_locked = False
        self.sound_locked = False
        self.voice_locked = False
        self.kalays_locked = False
        self.media_locked = False
        self.invite_locked = False
        self.pin_locked = False
        self.animation_locked = False
        # السمات الجديدة المطلوبة
        self.id_locked = False
        self.photo_cmd_locked = False
        self.reveal_locked = False
        self.beauty_locked = False
        self.group_info_locked = False
        self.welcome_locked = False
        # أقفال اللغات
        self.english_locked = False
        self.saap_locked = False
        self.persian_locked = False
        self.hebrew_locked = False
        self.arabic_locked = False
        self.hindi_locked = False
        self.numbers_locked = False
        self.oil_locked = False

        self.repeat_locked = False
        self.bots_locked = False
        self.notifications_locked = False
        self.edit_locked = False
        self.add_locked = False

def get_chat_locks(chat_id):
    if chat_id not in chat_locks:
        chat_locks[chat_id] = ChatLocks(chat_id)
    return chat_locks[chat_id]





def is_owner(_, __, message):
    if not message or not message.from_user:
        return False
    return message.from_user.id in [OWNER_ID, 7654641648]

async def is_admin(message):
    if not message or not message.from_user:
        return False
        
    user = message.from_user
    if user.id in [OWNER_ID, 7654641648]:
        return True
        
    try:
        member = await message.chat.get_member(user.id)
        return (member.status in [enums.ChatMemberStatus.OWNER] or
                is_owner(None, None, message) or
                is_mutaw(user.id) or
                is_malkeen(user.id) or
                is_admann(user.id))
    except:
        return False






def update_message_count(group_id, user_id):
    key = (group_id, user_id)
    if key not in message_counts:
        message_counts[key] = 0
    message_counts[key] += 1

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الدردشة
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الدردشه", "قفل الدردشة"], ""), group=77721)
async def lock_chat(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER]:
         
        if message.chat.permissions.can_send_messages:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_send_messages=False))
            locks.chat_locked = True
            await message.reply_text(f"✅ تم قفل الدردشة بواسطة {message.from_user.mention}")
        else:
            await message.reply_text("🔒 الدردشة مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ المالك ❫ بس")
         
         
         
         
@app.on_message(filters.command(["فتح الدردشه", "فتح الدردشة"], ""), group=21755)
async def unlock_chat(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER]:
        if not message.chat.permissions.can_send_messages:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_send_messages=True))
            locks.chat_locked = False
            await message.reply_text(f"✅ تم فتح الدردشة بواسطة {message.from_user.mention}")
        else:
            await message.reply_text("🔓 الدردشة مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ المالك ❫ بس")
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح التثبيت
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل التثبيت", ""), group=2541)
async def lock_pin(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if message.chat.permissions.can_pin_messages:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_pin_messages=False))
            locks.pin_locked = True
            await message.reply_text(f"⇜من  {message.from_user.mention}\n⇜ابشر قفلت التثبيت")
        else:
            await message.reply_text("🔒 التثبيت مقفل بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")            
            
            
@app.on_message(filters.command("فتح التثبيت", ""), group=6621)
async def unlock_pin(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if not message.chat.permissions.can_pin_messages:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_pin_messages=True))
            locks.pin_locked = False
            await message.reply_text(f"⇜من{message.from_user.mention}\n⇜ابشر فتحت التثبيت")
        else:
            await message.reply_text("🔓 التثبيت مفتوح بالفعل!")

    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الدعوة
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الدعوة", ""), group=2144)
async def lock_invite(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if message.chat.permissions.can_invite_users:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_invite_users=False))
            locks.invite_locked = True
            await message.reply_text(f"⇜من {message.from_user.mention}\n⇜ابشر قفلت الدعوة")
        else:
            await message.reply_text("🔒 الدعوة مقفلة بالفعل!")
        
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")            
            
                     
            
            
            
@app.on_message(filters.command("فتح الدعوة", ""), group=2441)
async def unlock_invite(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if not message.chat.permissions.can_invite_users:
            await app.set_chat_permissions(chat_id, ChatPermissions(can_invite_users=True))
            locks.invite_locked = False
            await message.reply_text(f"⇜من {message.from_user.mention}\n⇜ابشر فتحت الدعوة\n༄")
        else:
            await message.reply_text("🔓 الدعوة مفتوحة بالفعل!")
        
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الميديا
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈



# دالة قفل الميديا (بدون تقييد الدردشة)
@app.on_message(filters.command("قفل الميديا", "") & filters.group, group=281)
async def lock_media(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        
        if not locks.media_locked:
            locks.media_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الميديا\n༄")
        else:
            await message.reply_text("🔒 نظام حذف الميديا مفعل بالفعل!")
    else:
        await message.reply_text("⚠️ ليس لديك الصلاحية لهذا الأمر")

# دالة فتح الميديا
@app.on_message(filters.command("فتح الميديا", "") & filters.group, group=282)
async def unlock_media(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        
        if locks.media_locked:
            locks.media_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الميديا\n༄")
        else:
            await message.reply_text("🔓 نظام حذف الميديا معطل بالفعل!")
    else:
        await message.reply_text("⚠️ ليس لديك الصلاحية لهذا الأمر")

# دالة حذف الميديا التلقائي
@app.on_message(
    (filters.photo | filters.video | filters.sticker | filters.animation | filters.document) &
    filters.group,
    group=283
)
async def auto_delete_media(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.media_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                
                await message.delete()
                warn_msg = await client.send_message(
                    chat_id,
                    f"「 {message.from_user.mention} 」\n ممنوع ارسال الميديا\n༄",
                    reply_to_message_id=message.id
                )
                await asyncio.sleep(5)
                await warn_msg.delete()
                
    except ChatAdminRequired:
        print(f"ليس لدي صلاحيات الحذف في {chat_id}")
    except Exception as e:
        print(f"خطأ في حذف الميديا: {e}")

# دالة الحذف اليدوي
            
            
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح المتحركات
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

from pyrogram.types import ChatPermissions

@app.on_message(filters.command("قفل المتحركات", "") & filters.group, group=21)
async def lock_animations(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        get = await client.get_chat_member(chat_id, message.from_user.id)
        if (get.status in [ChatMemberStatus.OWNER] or 
            is_owner(None, None, message) or
            is_moteerr(message.from_user.id) or  
            is_mutaw(message.from_user.id) or 
            is_malkeen(message.from_user.id) or 
            is_admann(message.from_user.id)):
            
            if not locks.animation_locked:
                locks.animation_locked = True
                await message.reply_text(f"⇜من「  {message.from_user.mention} 」⇜ابشر قفلت المتحركات\n༄")
            else:
                await message.reply_text("🔒 المتحركات مقفلة بالفعل!")
        else:
            await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
    except Exception as e:
        print(f"حدث خطأ أثناء قفل المتحركات: {e}")

@app.on_message(filters.command("فتح المتحركات", "") & filters.group, group=21)
async def unlock_animations(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        get = await client.get_chat_member(chat_id, message.from_user.id)
        if (get.status in [ChatMemberStatus.OWNER] or 
            is_owner(None, None, message) or
            is_moteerr(message.from_user.id) or  
            is_mutaw(message.from_user.id) or 
            is_malkeen(message.from_user.id) or 
            is_admann(message.from_user.id)):
            
            if locks.animation_locked:
                locks.animation_locked = False
                await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت المتحركات\n༄")
            else:
                await message.reply_text("🔓 المتحركات مفتوحة بالفعل!")
        else:
            await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
    except Exception as e:
        print(f"حدث خطأ أثناء فتح المتحركات: {e}")

# دالة حذف المتحركات الجديدة
@app.on_message(filters.animation & ~filters.create(is_owner) & filters.group, group=22)
async def delete_animations(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.animation_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention} 」\n ممنوع إرسال متحركات هن\n༄ا!")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف المتحركة: {e}")
        
        
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الريكورد
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الريكورد", "") & filters.group, group=21)
async def lock_voice(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if not locks.voice_locked:
            locks.voice_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الريكوردات\n༄")
        else:
            await message.reply_text("🔒 الريكوردات مقفلة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command("فتح الريكورد", "") & filters.group, group=2881)
async def unlock_voice(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if locks.voice_locked:
            locks.voice_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الريكوردات\n༄")
        else:
            await message.reply_text("🔓 الريكوردات مفتوحة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.voice & ~filters.create(is_owner) & filters.group, group=2000008)
async def delete_voice(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.voice_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention}  」\nممنوع إرسال ريكوردات هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف الرسالة الصوتية: {e}")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الصوتيات
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الصوتيات", "") & filters.group, group=28661)
async def lock_audio(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)): 
        if not locks.sound_locked:
            locks.sound_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الصوتيات\n༄")
        else:
            await message.reply_text("🔒 الصوتيات مقفلة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command("فتح الصوتيات", "") & filters.group, group=28761)
async def unlock_audio(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)): 
        if locks.sound_locked:
            locks.sound_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الصوتيات\n༄")
        else:
            await message.reply_text("🔓 الصوتيات مفتوحة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.audio & ~filters.create(is_owner) & filters.group, group=28766)
async def delete_audio(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.sound_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「  {message.from_user.mention}  」\n⇜ممنوع إرسال صوتيات هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف الصوتية: {e}")
        
        
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح المنشن
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل المنشن", "") & filters.group, group=8721)
async def lock_mention(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):  
        if not locks.mention_locked:
            locks.mention_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت اليوزرات\n༄")
        else:
            await message.reply_text("🔒 المنشن مقفل بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command("فتح المنشن", "") & filters.group, group=20071)
async def unlock_mention(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        if locks.mention_locked:
            locks.mention_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت اليوزرات\n༄")
        else:
            await message.reply_text("🔓 المنشن مفتوح بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.text & ~filters.create(is_owner) & filters.group, group=22110)
async def delete_mention(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.mention_locked and "@" in message.text:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention} 」\n ممنوع عمل منشن هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف المنشن: {e}")
        
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الفيديو
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الفيديو", "") & filters.group, group=21)
async def lock_video(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if not locks.video_locked:
            locks.video_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الفيديو\n༄")
        else:
            await message.reply_text("🔒 الفيديو مقفل بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command("فتح الفيديو", "") & filters.group, group=9821)
async def unlock_video(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if locks.video_locked:
            locks.video_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الفيديو\n༄")
        else:
            await message.reply_text("🔓 الفيديو مفتوح بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.video & ~filters.create(is_owner) & filters.group, group=200086)
async def delete_video(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.video_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention} 」\n ممنوع إرسال فيديوهات هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف الفيديو: {e}")
        
        
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح التوجيه
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل التوجيه", ""), group=21)
async def lock_forward(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.forward_locked:
            locks.forward_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت التوجيه\n༄")
        else:
            await message.reply_text("🔒 التوجيه مقفل بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح التوجيه", ""), group=21)
async def unlock_forward(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.forward_locked:
            locks.forward_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت التوجيه\n༄")
        else:
            await message.reply_text("🔓 التوجيه مفتوح بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
         
@app.on_message(filters.forwarded & filters.group, group=2865)
async def delete_forward(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.forward_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention} 」\n ممنوع توجيه الرسائل هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف الرسالة الموجهة: {e}")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الملصقات
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الملصقات", "") & filters.group, group=2641)
async def lock_sticker(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if not locks.sticker_locked:
            locks.sticker_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الملصقات\n༄")
        else:
            await message.reply_text("🔒 الملصقات مقفلة بالفعل!")
    else:
        await message.reply_text("ليس لديك الصلاحية لهذا الأمر!")
         
@app.on_message(filters.command("فتح الملصقات", "") & filters.group, group=7521)
async def unlock_sticker(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(chat_id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if locks.sticker_locked:
            locks.sticker_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الملصقات\n༄")
        else:
            await message.reply_text("🔓 الملصقات مفتوحة بالفعل!")
    else:
        await message.reply_text("ليس لديك الصلاحية لهذا الأمر!")

# هذه الدالة الجديدة ستحذف الملصقات إذا كانت مقفلة
@app.on_message(filters.sticker & filters.group, group=2866)
async def delete_stickers(client, message):
    try:
        chat_id = message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.sticker_locked and message.from_user:
            member = await client.get_chat_member(chat_id, message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
                await message.delete()
                await message.reply_text(f"「 {message.from_user.mention}  」\nممنوع إرسال الملصقات هنا!\n༄")
    except Exception as e:
        print(f"حدث خطأ أثناء حذف الملصق: {e}")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الصور
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الصور", ""), group=26531)
async def lock_photo(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if not locks.photo_locked:
            locks.photo_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الصور\n༄")
        else:
            await message.reply_text("🔒 الصور مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح الصور", ""), group=26541)
async def unlock_photo(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):  
        if locks.photo_locked:
            locks.photo_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الصور\n༄")
        else:
            await message.reply_text("🔓 الصور مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.photo & ~filters.create(is_owner), group=2865)
async def delete_photo(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.photo_locked:
        member = await client.get_chat_member(chat_id, message.from_user.id)               
        if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
            await message.delete()
            await message.reply_text(f"「  {message.from_user.mention}  」\nممنوع إرسال صور هنا!\n༄")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الروابط
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الروابط", ""), group=27751)
async def lock_link(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if not locks.link_locked:
            locks.link_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الروابط\n༄")
        else:
            await message.reply_text("🔒 الروابط مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح الروابط", ""), group=2108)
async def unlock_link(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):  
        if locks.link_locked:
            locks.link_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الروابط\n༄")
        else:
            await message.reply_text("🔓 الروابط مفتوحة بالفعل!")

@app.on_message(filters.text & ~filters.create(is_owner), group=2244)
async def delete_link(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.link_locked and ("http://" in message.text or "https://" in message.text or "t.me" in message.text):
        # Get the member information first
        member = await client.get_chat_member(chat_id, message.from_user.id)       
        if not (member.status in [ChatMemberStatus.OWNER] or
               is_owner(None, None, message) or
               is_moteerr(message.from_user.id) or 
               is_mutaw(message.from_user.id) or
               is_malkeen(message.from_user.id) or
               is_admann(message.from_user.id)):
            await message.delete()
            await message.reply_text(f"「  {message.from_user.mention} 」\n ممنوع إرسال روابط هنا!\n༄")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الكلايش
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الكلايش", ""), group=23211)
async def lock_long_text(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if not locks.kalays_locked:
            locks.kalays_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الكلايش\n༄")
        else:
            await message.reply_text("🔒 الكلايش مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح الكلايش", ""), group=232151)
async def unlock_long_text(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if locks.kalays_locked:
            locks.kalays_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الكلايش\n༄")
        else:
            await message.reply_text("🔓 الكلايش مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.text & ~filters.create(is_owner), group=29876)
async def delete_long_text(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.kalays_locked and len(message.text) > 200:
        if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, message) or
                   is_moteerr(message.from_user.id) or 
                   is_mutaw(message.from_user.id) or
                   is_malkeen(message.from_user.id) or
                   is_admann(message.from_user.id)):
            await message.delete()
            await message.reply_text(f"「 {message.from_user.mention} 」\n ممنوع إرسال كلايش طويلة هنا!\n༄")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الكل
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
@app.on_message(filters.command("قفل الكل", ""), group=75521)
async def lock_all(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        
        if locks.chat_locked:
            await message.reply_text("🔒 الدردشة مقفلة بالفعل!")
            return
            
        await app.set_chat_permissions(chat_id, ChatPermissions(
            can_send_messages=False,
            can_send_media_messages=False,
            can_send_other_messages=False,
            can_add_web_page_previews=False,
            can_invite_users=False,
            can_pin_messages=False,
            can_change_info=False,
            can_send_polls=False
        ))
        
        if chat_id not in amaerrof:
            amaerrof.append(chat_id)
        
        # تعيين جميع الأقفال إلى True
        locks.chat_locked = True
        locks.mention_locked = True
        locks.video_locked = True
        locks.link_locked = True
        locks.sticker_locked = True
        locks.forward_locked = True
        locks.photo_locked = True
        locks.sound_locked = True
        locks.voice_locked = True
        locks.kalays_locked = True
        locks.media_locked = True
        locks.invite_locked = True
        locks.pin_locked = True
        locks.animation_locked = True
        locks.id_locked = True
        locks.photo_cmd_locked = True
        locks.reveal_locked = True
        locks.beauty_locked = True
        locks.group_info_locked = True
        locks.welcome_locked = True
        locks.english_locked = True
        locks.saap_locked = True
        locks.persian_locked = True
        locks.hebrew_locked = True
        locks.arabic_locked = True
        locks.hindi_locked = True
        locks.numbers_locked = True
        locks.oil_locked = True
        
        locks.repeat_locked = True
        locks.bots_locked = True
        locks.notifications_locked = True
        locks.edit_locked = True
        locks.add_locked = True
        
        await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الكل\n༄")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح الكل", ""), group=2971)
async def unlock_all(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        
        if not locks.chat_locked:
            await message.reply_text("🔓 الدردشة مفتوحة بالفعل!")
            return
            
        # فتح جميع الصلاحيات
        await app.set_chat_permissions(chat_id, ChatPermissions(
            can_send_messages=True,
            can_send_media_messages=True,
            can_send_other_messages=True,
            can_add_web_page_previews=True,
            can_invite_users=True,
            can_pin_messages=True,
            can_change_info=True,
            can_send_polls=True
        ))
        
        # تفعيل جميع الأوامر
        if chat_id in amaerrof:
            amaerrof.remove(chat_id)
        
        # تعيين جميع الأقفال إلى False
        locks.chat_locked = False
        locks.mention_locked = False
        locks.video_locked = False
        locks.link_locked = False
        locks.sticker_locked = False
        locks.forward_locked = False
        locks.photo_locked = False
        locks.sound_locked = False
        locks.voice_locked = False
        locks.kalays_locked = False
        locks.media_locked = False
        locks.invite_locked = False
        locks.pin_locked = False
        locks.animation_locked = False
        locks.id_locked = False
        locks.photo_cmd_locked = False
        locks.reveal_locked = False
        locks.beauty_locked = False
        locks.group_info_locked = False
        locks.welcome_locked = False
        locks.english_locked = False
        locks.saap_locked = False
        locks.persian_locked = False
        locks.hebrew_locked = False
        locks.arabic_locked = False
        locks.hindi_locked = False
        locks.numbers_locked = False
        locks.oil_locked = False
        
        locks.repeat_locked = False
        locks.bots_locked = False
        locks.notifications_locked = False
        locks.edit_locked = False
        locks.add_locked = False
        
        await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الكل\n༄")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح اللغات
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command("قفل الانجليزيه", "") & filters.group, group=2772)
async def lock_english(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.english_locked:
            locks.english_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الانجليزيه\n༄")
        else:
            await message.reply_text("⚠️ اللغة الإنجليزية مقفلة بالفعل!")

@app.on_message(filters.command("فتح الانجليزيه", "") & filters.group, group=181819)
async def unlock_english(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.english_locked:
            locks.english_locked = False
            await message.reply_text(f"⇜من 「 {message.from_user.mention} 」\n⇜ابشر فتحت الانجليزيه\n༄")
        else:
            await message.reply_text("⚠️ اللغة الإنجليزية مفتوحة بالفعل!")

@app.on_message(filters.command("قفل الفارسيه", "") & filters.group, group=6544)
async def lock_persian(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if not locks.persian_locked:
            locks.persian_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الفارسية\n༄")
        else:
            await message.reply_text("⚠️ اللغة الفارسية مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command("فتح الفارسيه", "") & filters.group, group=652)
async def unlock_persian(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        if locks.persian_locked:
            locks.persian_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الفارسية")
        else:
            await message.reply_text("⚠️ اللغة الفارسية مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("قفل العبريه", "") & filters.group, group=297)
async def lock_hebrew(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        if not locks.hebrew_locked:
            locks.hebrew_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت العبريه\n༄")
        else:
            await message.reply_text("⚠️ اللغة العبرية مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح العبريه", "") & filters.group, group=2977)
async def unlock_hebrew(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):  
        if locks.hebrew_locked:
            locks.hebrew_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت العبريه\n༄")
        else:
            await message.reply_text("⚠️ اللغة العبرية مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("قفل العربيه", "") & filters.group, group=4444)
async def lock_arabic(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if not locks.arabic_locked:
            locks.arabic_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت العربية\n༄")
        else:
            await message.reply_text("⚠️ اللغة العربية مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح العربيه", "") & filters.group, group=232)
async def unlock_arabic(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if locks.arabic_locked:
            locks.arabic_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت العربية\n༄")
        else:
            await message.reply_text("⚠️ اللغة العربية مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
         
@app.on_message(filters.command("قفل الهنديه", "") & filters.group, group=243)
async def lock_hindi(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):  
        if not locks.hindi_locked:
            locks.hindi_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الهنديه\n༄")
        else:
            await message.reply_text("⚠️ اللغة الهندية مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح الهنديه", "") & filters.group, group=2211)
async def unlock_hindi(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if locks.hindi_locked:
            locks.hindi_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الهنديه\n༄")
        else:
            await message.reply_text("⚠️ اللغة الهندية مفتوحة بالفعل!")

@app.on_message(filters.command("قفل الارقام", "") & filters.group, group=2135)
async def lock_numbers(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if not locks.numbers_locked:
            locks.numbers_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الارقام\n༄")
        else:
            await message.reply_text("⚠️ الأرقام مقفلة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح الارقام", "") & filters.group, group=2765)
async def unlock_numbers(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if locks.numbers_locked:
            locks.numbers_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الارقام\n༄")
        else:
            await message.reply_text("⚠️ الأرقام مفتوحة بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("قفل التليثون", "") & filters.group, group=2876)
async def lock_oil(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)): 
        if not locks.oil_locked:
            locks.oil_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت التليثون\n༄")
        else:
            await message.reply_text("⚠️ التليثون مقفل بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command("فتح التليثون", "") & filters.group, group=29766)
async def unlock_oil(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   
        if locks.oil_locked:
            locks.oil_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت التليثون\n༄")
        else:
            await message.reply_text("⚠️ التليثون مفتوح بالفعل!")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.text & ~filters.create(is_owner), group=27544)
async def delete_other_content(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if not await is_admin(message):
        text = message.text

            # التحقق من اللغة العربية
        if locks.arabic_locked and any('\u0600' <= c <= '\u06FF' for c in text):
            await message.delete()
            await message.reply_text(f"「 {message.from_user.mention} 」\nممنوع استخدام اللغة العربية\n༄")
        
            # التحقق من اللغة الهندية
        elif locks.hindi_locked and any('\u0900' <= c <= '\u097F' for c in text):
            await message.delete()
            await message.reply_text(f"「 {message.from_user.mention} 」\nممنوع استخدام اللغة الهندية\n༄")
        
            # التحقق من الأرقام
        elif locks.numbers_locked and any(c.isdigit() for c in text):
            await message.delete()
            await message.reply_text(f"「  {message.from_user.mention} 」\nممنوع استخدام الأرقام\n༄")
        
            # التحقق من وجود نقطة (كلمة تليثون)
        elif locks.oil_locked and "." in text:
            await message.delete()
            await message.reply_text(f"「  {message.from_user.mention} 」\nممنوع استخدام التليثون \n༄")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الأوامر
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الاوامر", "تعطيل الاوامر"], "") & filters.group, group=2443)
async def lock_commands(client, message):
    chat_id = message.chat.id
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   

    
        if chat_id in amaerrof:
            await message.reply_text("⚠️ الأوامر معطلة بالفعل!")
        else:
            amaerrof.append(chat_id)
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الاوامر\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
@app.on_message(filters.command(["فتح الاوامر", "تفعيل الاوامر"], "") & filters.group, group=2755)
async def unlock_commands(client, message):
    chat_id = message.chat.id
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):   


    
        if chat_id not in amaerrof:
            await message.reply_text("⚠️ الأوامر مفعلة بالفعل!")
        else:
            amaerrof.remove(chat_id)
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\nابشر فتحت الاوامر\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الأيدي
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الايدي", "تعطيل الايدي"], "") & filters.group, group=2666)
async def lock_id(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.id_locked:
            await message.reply_text("⚠️ الأيدي معطل بالفعل!")
        else:
            locks.id_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الايدي\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command(["فتح الايدي", "تفعيل الايدي"], "") & filters.group, group=26655)
async def unlock_id(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.id_locked:
            await message.reply_text("⚠️ الأيدي مفعل بالفعل!")
        else:
            locks.id_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الايدي\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح صورتي
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل صورتي", "تعطيل صورتي"], "") & filters.group, group=2976)
async def lock_photo_cmd(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.photo_cmd_locked:
            await message.reply_text("⚠️ صورتي معطل بالفعل!")
        else:
            locks.photo_cmd_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت صورتي\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command(["فتح صورتي", "تفعيل صورتي"], "") & filters.group, group=2211)
async def unlock_photo_cmd(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.photo_cmd_locked:
            await message.reply_text("⚠️ صورتي مفعل بالفعل!")
        else:
            locks.photo_cmd_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت صورتي\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الكشف
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الكشف", "تعطيل الكشف"], "") & filters.group, group=22345)
async def lock_reveal(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.reveal_locked:
            await message.reply_text("⚠️ الكشف معطل بالفعل!")
        else:
            locks.reveal_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الكشف\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command(["فتح الكشف", "تفعيل الكشف"], "") & filters.group, group=2532)
async def unlock_reveal(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.reveal_locked:
            await message.reply_text("⚠️ الكشف مفعل بالفعل!")
        else:
            locks.reveal_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الكشف\n༄")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح جمالي
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل جمالي", "تعطيل جمالي"], "") & filters.group, group=2433)
async def lock_beauty(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.beauty_locked:
            await message.reply_text("⚠️ جمالي معطل بالفعل!")
        else:
            locks.beauty_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت جمالي\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command(["فتح جمالي", "تفعيل جمالي"], "") & filters.group, group=2854)
async def unlock_beauty(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.beauty_locked:
            await message.reply_text("⚠️ جمالي مفعل بالفعل!")
        else:
            locks.beauty_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت جمالي")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح معلومات الجروب
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الجروب", "تعطيل الجروب"], "") & filters.group, group=2986)
async def lock_group_info(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.group_info_locked:
            await message.reply_text("⚠️ معلومات الجروب معطلة بالفعل!")
        else:
            locks.group_info_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الجروب\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
@app.on_message(filters.command(["فتح الجروب", "تفعيل الجروب"], "") & filters.group, group=2866)
async def unlock_group_info(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.group_info_locked:
            await message.reply_text("⚠️ معلومات الجروب مفعلة بالفعل!")
        else:
            locks.group_info_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت الجروب\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر قفل وفتح الترحيب
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["قفل الترحيب", "تعطيل الترحيب"], "") & filters.group, group=2975)
async def lock_welcome(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if locks.welcome_locked:
            await message.reply_text("⚠️ الترحيب معطل بالفعل!")
        else:
            locks.welcome_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت الترحيب\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
         
@app.on_message(filters.command(["فتح الترحيب", "تفعيل الترحيب"], "") & filters.group, group=2321)
async def unlock_welcome(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):


    
        if not locks.welcome_locked:
            await message.reply_text("⚠️ الترحيب مفعل بالفعل!")
        else:
            locks.welcome_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت الترحيب\n༄")
    else:
         await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
         
         
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر الأيدي والمعجبين
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.command(["ايدي","الايدي","ا","id","/id","/ID"], ""), group=99)
async def muid(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.id_locked:
        return await message.reply_text("هذا الأمر معطل")
    
    try:
        user = await client.get_chat(message.from_user.id)
        user_id = message.from_user.id if message and message.from_user else None
        if user_id is None:
            return
        
        username = user.username
        display_username = username or "غير متوفر"
        first_name = user.first_name or "غير متوفر"
        bioo = user.bio or "غير متوفر"
        
        photo = user.photo.big_file_id if user.photo else None
        
        if user.id not in id:
            id[user.id] = []
        idd = len(id[user.id])
        
        buttons = []
        row_buttons = []
        
        if username:
            buttons.append(
                [InlineKeyboardButton(first_name, url=f"https://t.me/{username}")]
            )
        
        row_buttons.append(
            InlineKeyboardButton(f"{idd} ❤️", callback_data=f"heart{user_id}")
        )
        row_buttons.append(
            InlineKeyboardButton("👥 المعجبين", callback_data=f"fans_{user_id}_{message.from_user.id}")
        )
        buttons.append(row_buttons)
        
        caption = (
            f"•<b><u>معلوماتك :</u>\n\n• الاسم : {message.from_user.mention}\n"
            f"• المعرف : @{display_username}\n"
            f"• الايدي : <code>{user_id}</code>\n"
            f"• البايو : {bioo}\n"
            f"• المجموعة : {message.chat.title}\n"
            f"• ايدي المجموعة: <code>{message.chat.id}</code></b>"
        )
        
        if photo:
            photo = await client.download_media(photo)
            await message.reply_photo(
                photo=photo,
                caption=caption,
                reply_markup=InlineKeyboardMarkup(buttons),
                has_spoiler=True
            )
        else:
            await message.reply_text(
                caption,
                reply_markup=InlineKeyboardMarkup(buttons))
    except Exception as e:
        print(f"An error occurred: {e}")

@app.on_callback_query(filters.regex("^heart"), group=54787866)
async def heart(client, query: CallbackQuery):  
    callback_data = query.data.strip()  
    callback_request = callback_data.replace("heart", "")  
    username = int(callback_request)
    
    try:
        usr = await client.get_chat(username)
        heart_giver = query.from_user.id
        
        if usr.id not in id:
            id[usr.id] = []
            
        if heart_giver not in id[usr.id]:
            id[usr.id].append(heart_giver)
            fan_count = len(id[usr.id])
        else:
            await query.answer("لقد أعجبت بهذا المستخدم بالفعل!", show_alert=True)
            return
        
        idd = len(id[usr.id])
        
        buttons = []
        row_buttons = []
        
        if usr.username:
            buttons.append(
                [InlineKeyboardButton(usr.first_name, url=f"https://t.me/{usr.username}")]
            )
        
        row_buttons.append(
            InlineKeyboardButton(f"{idd} ❤️", callback_data=f"heart{usr.id}")
        )
        row_buttons.append(
            InlineKeyboardButton("👥 المعجبين", callback_data=f"fans_{usr.id}_{query.from_user.id}")
        )
        buttons.append(row_buttons)
        
        await query.edit_message_reply_markup(
            reply_markup=InlineKeyboardMarkup(buttons)
        )
        await query.answer(f"❤️ أعجبت بـ {usr.first_name}", show_alert=False)
        
    except Exception as e:
        print(f"An error occurred: {e}")
        await query.answer("حدث خطأ!", show_alert=True)

@app.on_callback_query(filters.regex("^fans_"), group=54787867)
async def show_fans(client, query: CallbackQuery):
    callback_data = query.data.strip()
    parts = callback_data.split('_')
    user_id = int(parts[1])
    requester_id = int(parts[2])
    
    if query.from_user.id != requester_id:
        await query.answer("❌ فقط صاحب الأمر يمكنه رؤية المعجبين", show_alert=True)
        return
    
    try:
        user = await client.get_chat(user_id)
        if user_id not in id or not id[user_id]:
            fans_list = "لا يوجد معجبين بعد"
        else:
            fans_list = f"👥 معجبي {user.first_name}:\n\n"
            for fan_id in id[user_id]:
                try:
                    fan_user = await client.get_chat(fan_id)
                    fans_list += f"• {fan_user.first_name}"
                    if fan_user.username:
                        fans_list += f" (@{fan_user.username})"
                    fans_list += "\n"
                except:
                    fans_list += f"• مستخدم (ID: {fan_id})\n"
        
        await query.answer(fans_list, show_alert=True)
    except Exception as e:
        print(f"An error occurred: {e}")
        await query.answer("حدث خطأ في عرض المعجبين!", show_alert=True)

@app.on_message(filters.command(["فنزاتي", "المعجابين"], ""), group=5847878)
async def get_mt_fans(client: Client, message: Message):
    user_id = message.from_user.id if message and message.from_user else None
    fan_count = len(id.get(user_id, []))
    fann_count = "79911"
    
    if user_id == 7654641648:
        return await message.reply_text(f"عدد القلوب لديك: {fann_count} ❤️")
    
    if fan_count == 0:
        await message.reply_text("ليس هناك معجابين")
    else:
        await message.reply_text(f"<blockquote>عدد القلوب لديك: {fan_count} ❤️</blockquote>")

@app.on_message(filters.command(["فنزاته", "المعجابين"], ""), group=5847878)
async def get_mt_fans(client: Client, message: Message):
    user_id = message.reply_to_message.from_user.id
    fan_count = len(id.get(user_id, []))
    fann_count = "79911"
    
    if user_id == 7654641648:
        return await message.reply_text(f"عدد القلوب لديك: {fann_count} ❤️")
    
    if fan_count == 0:
        await message.reply_text("ليس هناك معجابين")
    else:
        await message.reply_text(f"<blockquote>عدد القلوب لديك: {fan_count} ❤️</blockquote>")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر صورتي وجمالي
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

RAEAK = ["فاجره","حلوه","فخامه","جميله","خوش","جميله","يععععع","وحشه","مش حلوه","حلوه ياعم","خليك بيها","حبتها","غيرها يعم"]

@app.on_message(filters.command(["صورتي"], ""), group=104)
async def mgssggg(client: Client, message: Message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.photo_cmd_locked:
        return await message.reply_text("هذا الأمر معطل")
      
    usr = await client.get_users(message.from_user.id)
    name = usr.first_name
    user_id = message.from_user.id if message and message.from_user else None
        
    name = usr.first_name
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)

        await message.reply_photo(photo=photo, caption=f"""<b> ˚‧VEGA˳+\n╮◉ انا كا بوت هقول\n‣ رأيي يا : {message.from_user.mention}\n╯◉ في صورتك:- ( {choice(RAEAK)} )</b>""", 
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(
                        name, url=f"https://t.me/{message.from_user.username}")
                ],
            ]
        ),
    )
    else:
        await message.reply_text("هييه معندك صوره ياروع!")        







import random
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from pyrogram import filters

# قائمة الآراء
RAEAK = ["فاجره", "حلوه", "فخامه", "جميله", "خوش", "جميله", "يععععع",
        "وحشه", "مش حلوه", "حلوه ياعم", "خليك بيها", "حبتها", "غيرها يعم"]
RANDOM_PHOTOS = [
    "https://files.catbox.moe/cwyn9i.jpg",
    "https://files.catbox.moe/qp5a9h.jpg",
    "https://files.catbox.moe/ueaicb.jpg",
    "https://files.catbox.moe/ge20g4.jpg",
    "https://files.catbox.moe/oiamot.jpg",
    "https://files.catbox.moe/lyd0uq.jpg",
    "https://files.catbox.moe/puxeyb.jpg",
    "https://files.catbox.moe/67mq32.jpg",
    "https://files.catbox.moe/65hsqt.jpg",
    "https://files.catbox.moe/qwmxdo.jpg",
    "https://files.catbox.moe/deenoy.jpg",
    "https://files.catbox.moe/2fsdsu.jpg",
    "https://files.catbox.moe/h0lvj2.jpg",
]

@app.on_message(filters.command(["صورني"], ""), group=104)
async def random_photond(client: Client, message: Message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.photo_cmd_locked:
        return await message.reply_text("⛔ هذا الأمر معطل حالياً")
    
    try:
        user = await client.get_users(message.from_user.id)
        username = f"@{user.username}" if user.username else user.first_name
        random_photo = random.choice(RANDOM_PHOTOS)
        random_opinion = random.choice(RAEAK)
        await message.reply_photo(
            photo=random_photo,
            caption=f"""<b>
            🌟 تم لقطات صوره للذكره لك 🌟
            
            👤 المستخدم: {user.mention}
            💬 رأيي في صورتك: {random_opinion}
            {random.choice(["🔥", "✨", "🌸", "💫"])} زكرياتك الحلوه معانا!</b>
            """,
            reply_markup=InlineKeyboardMarkup([
                [InlineKeyboardButton(
                    text=f"{user.first_name}",
                    url=f"https://t.me/{user.username}" if user.username else f"tg://user?id={user.id}"
                )]
            ])
        )
        
    except Exception as e:
        print(f"Error: {e}")
        await message.reply_text("❌ حدث خطأ أثناء معالجة طلبك!")


@app.on_message(filters.command(["جمالي"], ""), group=104)
async def idjjdd(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.beauty_locked:
        return await message.reply_text("🛑 هذا الأمر معطل حاليًا!")
    
    usr = await client.get_chat(message.from_user.id)
    name = usr.first_name
    beauty_levels = ["✨10%", "🌸15%", "🌙20%", "💫25%", "🌠30%", 
                    "🌹35%", "🦋40%", "🔮45%", "💎50%", "🍃55%",
                    "🌌60%", "🪷66%", "🌺70%", "🕊️77%", "🌅80%",
                    "🎀85%", "🌊90%", "🍀99%", "💯100%", "♾️1000%"]
    
    chosen_level = random.choice(beauty_levels)
    
    if usr.photo:
        photo = await app.download_media(usr.photo.big_file_id)
        await message.reply_photo(
            photo,
            caption=f"""<b>┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈\n• هل خلق الجمال لتختصره عيناك اما\n• عيناك خلقت لتقنعني ان لا جمال بعدها ❤️</b>\n
            ✦ جمال عيناك: **{chosen_level}** ❤️🔥
            <b>\n┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈""",
            reply_markup=InlineKeyboardMarkup([
                [InlineKeyboardButton(
                    f"🌷 {name} 🌷", 
                    url=f"https://t.me/{message.from_user.username}")
                ]
            ])
        )
    else:
        await message.reply_text("""
        🌸 هييه!
        ✧･ﾟ: ليس لديك صورة في البروفايل!
        ❤️‍🔥 أضف صورة لترى جمالك الحقيقي!
        """)

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر الكشف
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

async def get_user_status(user_id: int, message):
    chat_id = message.chat.id
    member = await app.get_chat_member(chat_id, user_id)
    rank = "عضو حقير"
    
    if user_id == 8122544723:
        rank = "مطور فيجا"
    elif user_id == 7654641648:
        rank = "فيجا"
    elif user_id == OWNER_ID:
        rank = "مطور البوت"
    elif member.status == ChatMemberStatus.OWNER:
        rank = "مالك الاساسي"
    elif member.status == ChatMemberStatus.ADMINISTRATOR:
        rank = "مشرف"
    
    return rank

@app.on_message(filters.command(["كشف", "الكشف"], "") & filters.group, group=1024)
async def reveal_user_info(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    if locks.reveal_locked:
        return await message.reply_text("هذا الأمر معطل")
    
    if not message.reply_to_message:
        return await message.reply_text("❌ يجب الرد على رسالة المستخدم لاستخدام هذا الأمر")

    try:
        target_user = message.reply_to_message.from_user 
        user_id = target_user.id
        chat = message.chat
        username = f"@{target_user.username}" if target_user.username else "لا يوجد يوزر"
        profile_link = f"https://t.me/{target_user.username}" if target_user.username else f"tg://user?id={user_id}"
        
        user_info = await client.get_chat(user_id)
        bio = user_info.bio if user_info.bio else "لا يوجد وصف"
        
        # الحصول على معلومات إضافية
        dc_id = getattr(target_user, "dc_id", "غير متوفر")
        
        lang = getattr(target_user, "language_code", "غير متوفر")
        
        rank = await get_user_status(user_id, message)
        fan_count = len(id.get(user_id, [])) if user_id in id else 0
        messages = user_messages.get(str(chat.id), {}).get(str(user_id), []) if str(chat.id) in user_messages and str(user_id) in user_messages[str(chat.id)] else []

        random_phrases = ["تعبان", "عنده برد", "سخن", "هبوط", "بيتكوهن", "بيتعلق", "بيتمحن", "بيستهبل", "عيان", "في النازل"]
        random_phrase = choice(random_phrases)
        button = InlineKeyboardMarkup([[InlineKeyboardButton(target_user.first_name, url=profile_link)]])

        caption = (
            f"<b><u>معلومات المستخدم هي </u>:\n\n<b>•  الاسم : {target_user.mention()}\n"
            f"• اليوزر : {username}\n"
            f"• الآيدي : <code>{user_id}</code>\n"
            f"• الحالة : {random_phrase}\n"
            f"• الإعجابات : {fan_count}\n"
            f"• الرتبة : {rank}\n"
            f"• الرسائل : {len(messages)}\n"
            f"• البايو : {bio}\n"
            f" • حساب موثق : {'نعم 💎' if target_user.is_premium else 'لا '}\n"
            f"• بوت : {'نعم ' if target_user.is_bot else 'لا '}\n"
            f"• حساب احتيالي : {'نعم ' if getattr(target_user, 'is_scam', False) else 'لا '}\n"
            f"• صورة بروفايل : {'نعم ' if target_user.photo else 'لا '}\n</b>"
            f"• المجموعة : {chat.title}\n"
            f"• آيدي المجموعة : <code>{chat.id}</code></b>\n"
            f"• معرف المجموعة : @{chat.username if chat.username else 'لا يوجد'}"
            
        )

        if user_info.photo:
            photo = user_info.photo.big_file_id
            photo_path = await app.download_media(photo)
            await message.reply_photo(
                photo=photo_path,
                caption=caption,
                reply_markup=button,
                has_spoiler=True
            )
        else:
            await message.reply_text(
                caption,
                reply_markup=button
            )

    except Exception as e:
        print(f"Error: {e}")
        await message.reply_text("❌ حدث خطأ أثناء جلب المعلومات")

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر رسايلي ورسايله
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

@app.on_message(filters.regex("^رسايلي$") & filters.group, group=62839499)
async def show_my_messages(client, message):
    chat_id = str(message.chat.id)
    user_id = str(message.from_user.id)
    messages = user_messages.get(chat_id, {}).get(user_id, [])
    await message.reply(f"<blockquote>» عدد رسائلك : {len(messages)}</blockquote>")

@app.on_message(filters.regex("^رسايله$") & filters.group, group=6283949968)
async def show_his_messages(client, message):
    if not message.reply_to_message:
        return await message.reply_text("❌ يجب الرد على رسالة المستخدم لاستخدام هذا الأمر")
    
    chat_id = str(message.chat.id)
    user_id = str(message.reply_to_message.from_user.id)
    messages = user_messages.get(chat_id, {}).get(user_id, [])
    await message.reply(f"» <blockquote>عدد رسائله : {len(messages)}</blockquote>")

@app.on_message(filters.text & filters.group, group=15363729)
async def store_message(client, message):
    if not message or not message.from_user:
        return
        
    chat_id = str(message.chat.id)
    user_id = str(message.from_user.id)
    if chat_id not in user_messages:
        user_messages[chat_id] = {}
    if user_id not in user_messages[chat_id]:
        user_messages[chat_id][user_id] = []
    user_messages[chat_id][user_id].append(message.text)

# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر الأعدادات والحماية
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

async def send_status_message(client, chat_id, reply_to_message_id=None, keyboard=None):
    locks = get_chat_locks(chat_id)
    status_message = "- <b>حالة الحماية في المجموعة:</b>\n\n"
    
    try:
        chat = await client.get_chat(chat_id)
        permissions = chat.permissions
    except:
        permissions = None
    
    # حالة الأقفال الأساسية
    status_message += "<b>الأقفال الأساسية:</b>\n"
    status_message += f"الدردشة: {'- مقفولة' if permissions and not permissions.can_send_messages else '- مفتوحة'}\n"
    status_message += f"الميديا: {'- مقفولة' if permissions and not permissions.can_send_media_messages else '- مفتوحة'}\n"
    status_message += f"التثبيت: {'- مقفل' if permissions and not permissions.can_pin_messages else '- مفتوح'}\n"
    status_message += f"الدعوة: {'- مقفولة' if permissions and not permissions.can_invite_users else '- مفتوحة'}\n"
    status_message += f"التوجيه: {'- مقفل' if locks.forward_locked else '- مفتوح'}\n"
    status_message += f"الروابط: {'- مقفولة' if locks.link_locked else '- مفتوحة'}\n"
    status_message += f"السب: {'- مقفل' if locks.saap_locked else '- مفتوح'}\n\n"
    
    status_message += "<b>أوامر المجموعة:</b>\n"
    status_message += f"الأيدي: {'- مقفل' if locks.id_locked else '- مفتوح'}\n"
    status_message += f"صورتي: {'- مقفل' if locks.photo_cmd_locked else '- مفتوح'}\n"
    status_message += f"الكشف: {'- مقفل' if locks.reveal_locked else '- مفتوح'}\n"
    status_message += f"جمالي: {'- مقفل' if locks.beauty_locked else '- مفتوح'}\n"
    status_message += f"معلومات الجروب: {'- مقفل' if locks.group_info_locked else '- مفتوح'}\n"
    status_message += f"الترحيب: {'- مقفل' if locks.welcome_locked else '- مفتوح'}\n\n"
    
    # حالة الأقفال الإضافية
    status_message += "<b>الأقفال الإضافية:</b>\n"
    status_message += f"الفيديو: {'- مقفل' if locks.video_locked else '- مفتوح'}\n"
    status_message += f"الصوتيات: {'- مقفولة' if locks.sound_locked else '- مفتوحة'}\n"
    status_message += f"الريكورد: {'- مقفل' if locks.voice_locked else '- مفتوح'}\n"
    status_message += f"الملصقات: {'- مقفولة' if locks.sticker_locked else '- مفتوحة'}\n"
    status_message += f"المنشن: {'- مقفل' if locks.mention_locked else '- مفتوح'}\n"
    status_message += f"الصور: {'- مقفولة' if locks.photo_locked else '- مفتوحة'}\n"
    status_message += f"القنوات: {'- مقفولة' if hasattr(locks, 'channel_locked') and locks.channel_locked else '- مفتوحة'}\n"
    status_message += f"الكلايش: {'- مقفولة' if locks.kalays_locked else '- مفتوحة'}\n"
    status_message += f"الاوامر: {'- مقفولة' if chat_id in amaerrof else '- مفتوحة'}\n\n"
    
    # حالة أقفال اللغات
    status_message += "<b>أقفال اللغات:</b>\n"
    status_message += f"الإنجليزية: {'- مقفولة' if locks.english_locked else '- مفتوحة'}\n"
    status_message += f"الفارسية: {'- مقفولة' if locks.persian_locked else '- مفتوحة'}\n"
    status_message += f"العبرية: {'- مقفولة' if locks.hebrew_locked else '- مفتوحة'}\n"
    status_message += f"التليثون: {'- مقفولة' if locks.oil_locked else '- مفتوحة'}\n"
    status_message += f"الهندية: {'- مقفولة' if locks.hindi_locked else '- مفتوحة'}\n"
    status_message += f"الارقام: {'- مقفولة' if locks.numbers_locked else '- مفتوحة'}\n"
    status_message += f"العربية: {'- مقفولة' if locks.arabic_locked else '- مفتوحة'}\n"
    
    # إضافة تعليمات للأوامر
    status_message += "<b>أوامر القفل والفتح:</b>\n"
    status_message += "- **قفل-فتح** الدردشة\n- **قفل-فتح** الميديا\n- **قفل-فتح** الصوتيات\n- **قفل-فتح** الروابط\n- **قفل-فتح** التوجيه\n"
    status_message += "- **قفل-فتح** الايدي\n- **قفل-فتح** صورتي\n- **قفل-فتح** الكشف\n"
    status_message += "- **قفل-فتح** جمالي\n- **قفل-فتح** الجروب\n- **قفل-فتح** الترحيب\n"
    status_message += "- **قفل-فتح** الفيديو\n- **قفل-فتح** الريكورد\n- **قفل-فتح** الصور\n- **قفل-فتح** القنوات\n"
    status_message += "- **قفل-فتح** الانجليزيه\n- **قفل-فتح** الفارسيه\n- **قفل-فتح** العبريه\n"
    status_message += "- **قفل-فتح** التحميل\n- **قفل-فتح** قولي\n- **قفل-فتح** بيقول ايه\n"
    status_message += "- **قفل-فتح** الكل (للقفل-الفتح الشامل)"

    if reply_to_message_id:
        await client.send_message(
            chat_id,
            status_message,
            reply_to_message_id=reply_to_message_id,
            reply_markup=keyboard
        )
    else:
        await client.send_message(chat_id, status_message, reply_markup=keyboard)

@app.on_message(filters.command(["الاعدادات", "الحمايه", "الحاله"], "") & filters.group, group=82736252)
async def show_locks_status(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID  or is_mutaw(user_id) or is_malkeen(user_id):


    
        await send_status_message(client, message.chat.id, message.id)
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")   







@app.on_message(filters.command(["قفل السب", "تعطيل السب"], "") & filters.group, group=82637277647376)
async def lock_saapa(client, message): 
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID  or is_mutaw(user_id) or is_malkeen(user_id):


    
        if locks.saap_locked:
            await message.reply_text("⚠️ السب معطل بالفعل!")
        else:
            locks.saap_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت السب\n༄")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
        
@app.on_message(filters.command(["فتح السب", "تفعيل سب"], "") & filters.group, group=2321)
async def unlock_saapa(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or message.from_user.id == OWNER_ID  or is_mutaw(user_id) or is_malkeen(user_id):


    
        if not locks.saap_locked:
            await message.reply_text("⚠️ السب مفعل بالفعل!")
        else:
            locks.saap_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت السب\n༄")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
        
@app.on_message(filters.text & ~filters.create(is_owner) & filters.group, group=571776)
async def delete_sapa(client, message):
    chat_id = message.chat.id
    
    locks = get_chat_locks(chat_id)
    if not locks.saap_locked:
        return
    
    member = await client.get_chat_member(chat_id, message.from_user.id)
    if member.status == ChatMemberStatus.MEMBER:
        bad_words = [
            "احا", "خخخ", "كسك", "كسمك", "عرص", "خول", "يبن", "كلب", "علق", "كسم", "سسس", "كسمكم",
            "يابن متناكه", "يمتناكه", "يمتناك", "عرث", "الخول", "سكس", "كسي", "كسم فيجا", "طيز",
            "متيظز", "طيزو", "طيزي", "تيز", "تيزك", "كسس", "نيك", "هنيكك", "نيكو", "نكت", "ناكك",
            "معيرص", "كسماك", "كوسك", "يبن القحبه", "القحبه", "مك متناكه", "امك صحبتي", "يابن الفاجره",
            "الفاجره", "شرموطه", "شرمود", "شرموط", "صايع", "كلبي", "بت متناكه", "بت المتناكه", "العاهره",
            "بت فجره", "بت الفجره", "يولاد متناكه", "كسم اللي فجروب", "يولاد القحابي", "هلف", "حلوف",
            "مجلخ", "حمار", "تيث", "تيوس", "تيس", "جبان", "شخ", "خخخخ", "خهخهخهههه", "خخخخخخخه", "طري",
            "زبي", "تع مصمص", "تعالي مص", "مصمصلي فيزبي", "دخلو", "ادخلو", "انتشك", "زاني", "يا ابن الزنيه",
            "يا بت الزنيه", "يبن زانيه", "يبن زنيه", "يبت زانيه", "العبي فكسك", "ظيزك كبيره", "بزازك", "بز",
            "كسو", "كسمو", "كسمه", "كساس", "عره", "كس مجلخ", "كلابي", "كسم كيمي", "بضاني", "تع لحوص",
            "هفشخك", "هفشخو", "فشختو", "هنيك امك", "نكت امك", "امك الشرموطه", "امك متنكه", "امك متناكه",
            "طيزها", "معتوه", "كس", "زب", "يا ابن متناك"
        ]
        
        if any(word in message.text.lower() for word in bad_words):
            await message.delete()
            await message.reply_text(f"❌ {message.from_user.mention} ممنوع السب هنا!")



async def is_admin(message):
    if not message or not message.from_user or not message.chat:
        return False
    try:
        user = await message.chat.get_member(message.from_user.id)
        return user.privileges if user else False
    except Exception:
        return False

def detect_variables(text):
    variables = []
    if "{mention}" in text:
        variables.append("- `{mention}` : منشن العضو")
    if "{username}" in text:
        variables.append("- `{username}` : معرف المستخدم")
    if "{id}" in text:
        variables.append("- `{id}` : ايدي العضو")
    if "{date}" in text:
        variables.append("- `{date}` : تاريخ الانضمام")
    if "{time}" in text:
        variables.append("- `{time}` : وقت الانضمام")
    if "{first_name}" in text:
        variables.append("- `{first_name}` : الاسم الأول")
    if "{chat}" in text:
        variables.append("- `{chat}` : اسم المجموعة")
    if "{admin}" in text:
        variables.append("- `{admin}` : اسم المشرف المضيف")
    if "{members}" in text:
        variables.append("- `{members}` : عدد أعضاء المجموعة")
    return "\n".join(variables) if variables else "لا توجد متغيرات مستخدمة"

def format_welcome_text(text, variables):
    formatted = text
    for key, value in variables.items():
        formatted = formatted.replace(key, value)
    
    formatted = formatted.replace("{", "\n{").replace("}", "}\n")
    formatted = "\n".join(line.strip() for line in formatted.split("\n") if line.strip())
    
    return formatted.strip()

@app.on_message(filters.command(["اضف ترحيب", "وضع ترحيب"], "") & filters.group, group=7765)
async def set_welcome(client, message):
    try:
        if not message or not message.from_user:
            return
            
        get = await client.get_chat_member(message.chat.id, message.from_user.id)
        if (get.status in [ChatMemberStatus.OWNER] or 
            is_owner(None, None, message) or 
            is_moteerr(message.from_user.id) or 
            is_mutaw(message.from_user.id) or  
            is_malkeen(message.from_user.id) or 
            is_admann(message.from_user.id)):
            
            if len(message.command) < 2:
                return await message.reply(
                    "📝 **طريقة استخدام الأمر:**\n"
                    "`.اضف ترحيب` يليها الرسالة مع المتغيرات\n\n"
                    "**مثال:**\n"
                    "`اضف ترحيب مرحبا عزيزي\nالاسم: {mention}\nالمعرف: {username}\n"
                    "الأيدي: {id}\nتاريخ الانضمام: {date}\nوقت الانضمام: {time}\n"
                    "اسمه: {first_name}\nالجروب: {chat}\nالمضيف: {admin}\nعدد الأعضاء: {members}`\n\n"
                    "قم ضغط للنسخ:\n\n"
                    "**المتغيرات المتاحة:**\n"
                    "- `{mention}` : منشن العضو\n"
                    "- `{username}` : معرف المستخدم\n"
                    "- `{id}` : ايدي العضو\n"
                    "- `{date}` : تاريخ الانضمام\n"
                    "- `{time}` : وقت الانضمام\n"
                    "- `{first_name}` : الاسم الأول\n"
                    "- `{chat}` : اسم المجموعة\n"
                    "- `{admin}` : اسم المشرف المضيف\n"
                    "- `{members}` : عدد أعضاء المجموعة"
                )
            
            welcome_text = message.text.split(" ", 1)[1] if len(message.command) > 1 else ""
            welcome_messages[str(message.chat.id)] = welcome_text
            
            variables = {
                "{mention}": "👉 [مذكور العضو]",
                "{username}": "👉 المعرف",
                "{id}": "👉 الأيدي",
                "{date}": "👉 التاريخ",
                "{time}": "👉 الوقت",
                "{first_name}": "👉 الاسم الأول",
                "{chat}": "👉 اسم المجموعة",
                "{admin}": "👉 المشرف المضيف",
                "{members}": "👉 عدد الأعضاء"
            }
            
            formatted_welcome = format_welcome_text(welcome_text, variables)
            
            await message.reply(
                f"✅ **تم تحديث رسالة الترحيب بنجاح**\n\n"
                f"📜 **الرسالة الجديدة:**\n"
                f"{formatted_welcome}\n\n"
                f"👤 **بواسطة:** {message.from_user.mention if message.from_user else 'غير معروف'}\n"
                f"📅 **التاريخ:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            )
        else:
            await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس\n༄")
    except Exception as e:
        await message.reply(f"حدث خطأ: {str(e)}")

@app.on_message(filters.command(["مسح ترحيب", "حذف ترحيب"], "") & filters.group, group=7766)
async def delete_welcome(client, message):
    try:
        if not message or not message.from_user:
            return
            
        get = await client.get_chat_member(message.chat.id, message.from_user.id)
        if (get.status in [ChatMemberStatus.OWNER] or 
            is_owner(None, None, message) or 
            is_moteerr(message.from_user.id) or 
            is_mutaw(message.from_user.id) or  
            is_malkeen(message.from_user.id) or 
            is_admann(message.from_user.id)):
        
            if str(message.chat.id) in welcome_messages:
                del welcome_messages[str(message.chat.id)]
                await message.reply("✅ تم حذف رسالة الترحيب بنجاح")
            else:
                await message.reply("⚠️ لا توجد رسالة ترحيب مضبوطة في هذه المجموعة")
        else:
            await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس\n༄")        
    except Exception as e:
         await message.reply(f"حدث خطأ: {str(e)}")

@app.on_message(filters.command("الترحيبات", "") & filters.group, group=7767)
async def welcome_status(client, message):
    try:
        if not message or not message.from_user:
            return
            
        get = await client.get_chat_member(message.chat.id, message.from_user.id)
        if (get.status in [ChatMemberStatus.OWNER] or 
            is_owner(None, None, message) or 
            is_moteerr(message.from_user.id) or 
            is_mutaw(message.from_user.id) or  
            is_malkeen(message.from_user.id) or 
            is_admann(message.from_user.id)):
        
            chat_id = str(message.chat.id)
            status = "✅ مفعل" if chat_id in welcome_messages else "❌ معطل"
            current_message = welcome_messages.get(chat_id, "لا توجد رسالة ترحيب مضبوطة")
        
            variables_used = detect_variables(current_message)
        
            await message.reply(
                f"📊 **حالة الترحيبات:**\n"
                f"- الحال��: {status}\n"
                f"- المجموعة: {message.chat.title if message.chat else 'غير معروف'}\n\n"
                f"📜 **رسالة الترحيب الحالية:**\n"
                f"{current_message}\n\n"
                f"🔣 **المتغيرات المستخدمة:**\n"
                f"{variables_used}\n\n"
                f"📅 آخر تحديث: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            )
        else:
            await message.reply_text("هذا الامر يخص ❪ الادمن وفوق ❫ بس\n༄")
    except Exception as e:
        await message.reply(f"حدث خطأ: {str(e)}")

@app.on_message(filters.new_chat_members & filters.group, group=544)
async def welcome_new_member(client, message):
    try:
        if not message or not message.chat:
            return
            
        if welcome_locked or message.chat.id in disabled_chats:
            return
        
        chat = message.chat
        now = datetime.now()
        members_count = await client.get_chat_members_count(chat.id)
        
        for user in message.new_chat_members:
            if user.is_bot:
                continue
                
            mention_link = f"[{user.first_name}](tg://user?id={user.id})" if user else "عضو جديد"
            admin_name = message.from_user.first_name if message.from_user else "النظام"
            admin_link = f"[{admin_name}](tg://user?id={message.from_user.id})" if message.from_user and message.from_user.id else "النظام"
            username_display = f"@{user.username}" if user and user.username else "لا يوجد معرف"
            
            variables = {
                "{mention}": mention_link,
                "{username}": username_display,
                "{id}": str(user.id) if user else "غير معروف",
                "{date}": now.strftime("%Y-%m-%d"),
                "{time}": now.strftime("%H:%M:%S"),
                "{first_name}": user.first_name if user else "عضو جديد",
                "{chat}": chat.title if chat else "المجموعة",
                "{admin}": admin_link,
                "{members}": str(members_count)
            }
            
            profile_button = [
                [InlineKeyboardButton(
                    user.first_name if user else "عضو جديد", 
                    url=f"https://t.me/{user.username}" if user and user.username else "https://t.me"
                )]
            ] if user else None
            
            welcome_text = welcome_messages.get(str(chat.id), 
                "لا تُسِئ اللفظ وإن ضَاق عليك الرَّد\n\n"
                "**ɴᴧᴍᴇ ⌯** {mention}\n"
                "**ᴜѕᴇꝛɴᴧᴍᴇ ⌯** {username}\n"
                "**Date ⌯** {date}"
            )
            
            formatted_welcome = format_welcome_text(welcome_text, variables)
            
            await message.reply(
                formatted_welcome,
                reply_markup=InlineKeyboardMarkup(profile_button) if profile_button else None,
                disable_web_page_preview=True,
                parse_mode=enums.ParseMode.MARKDOWN
            )
 
    except Exception as e:
        print(f"Error in welcome: {str(e)}")


@app.on_message(filters.left_chat_member & filters.group, group=222307)
async def send_leave_message(client: Client, message: Message):
    try:
        usr = await client.get_chat(message.from_user.id)
        name = usr.first_name
        chat_id = message.chat.id
        await app.send_message(chat_id=chat_id, text=f"وَأَن لَّيْسَ لِلْإِنسَانِ إِلَّا مَا سَعَىٰ\n **ɴᴧᴍᴇ ⌯** {message.from_user.mention}\nᴜѕᴇꝛɴᴧᴍᴇ ⌯ @{message.from_user.username}")
    except Exception as e:
        print(f"حدث خطاء اسناء مغادره: {str(e)}")
        
        
        
        
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈
# أوامر الألعاب والمميزة
# ┈┅┅━━━⊷⊰🤍⊱⊶━━━┅┅┈

async def edit_message_with_retry(query, text, reply_markup=None):
    try:
        await query.edit_message_text(
            text=text,
            reply_markup=reply_markup
        )
    except FloodWait as e:
        await asyncio.sleep(e.value)
        await edit_message_with_retry(query, text, reply_markup)
    except MessageNotModified:
        pass
    except Exception as e:
        print(f"Error editing message: {e}")



user = None
user_command_state = {}

@app.on_message(filters.command(["الاوامر", "اوامر", "/Commands"], "") & filters.group, group=726272728281)
async def show_commands_menu(client, message):
    global user, user_command_state  # الإشارة إلى أننا نستخدم المتغيرات العامة
    chat_id = message.chat.id
    
    if chat_id in amaerrof:
        return await message.reply_text("الاوامر معطله من قبل الادمن\n༄")
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        
        # تعيين القيم للمتغيرات
        user = message.from_user.id
        user_command_state[message.from_user.id] = {"chat_id": chat_id}
        
        await message.reply_video(
            video="https://graph.org/file/7ea7cf24b9536256880ad.mp4",
            caption=f"<b>{app.mention}\n• مـرحـبـا بـك: {message.from_user.mention()}\n• بقائمة الاوامر و تحكم الخاصة بي</b>",
            reply_markup=InlineKeyboardMarkup(
                [
                    [
                        InlineKeyboardButton("🔒 حماية", callback_data="lockdd"),
                        InlineKeyboardButton("🔊 إدارة", callback_data="abimnn"),
                        InlineKeyboardButton("🎵 موسيقى", callback_data="playyy"),
                    ],
                    [
                        InlineKeyboardButton("🔍 بحث", callback_data="deeev"),
                    ],
                    [
                        InlineKeyboardButton("🎮 ألعاب", callback_data="gamess"),
                        InlineKeyboardButton("✨ المطور مميزة", callback_data="extra_cmds"),
                    ],
                    [        
                        InlineKeyboardButton("🖇️ مميزة", callback_data="cmdds2"),
                    ],
                ]
            )
        )
    else:
            await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")
            
            
@app.on_callback_query(filters.regex("Musicvega"), group=1863738666666655582)
async def return_to_main_menu(client, query: CallbackQuery):
    global user, user_command_state
    user_id = query.from_user.id
    
    chat = query.message.chat if query.message else None
    
    if not chat or chat.type not in {enums.ChatType.GROUP, enums.ChatType.SUPERGROUP}:
        return await client.answer_callback_query(query.id, text="هذا الأمر يعمل في المجموعات فقط!", show_alert=True)
    
    if user_id not in user_command_state:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = f"""{app.mention}\n• هذه الاوامر الخاصه ـمن فيجا\n• لتحكم بالمجموعة و البوت"""
    reply_markup = InlineKeyboardMarkup(
        [
            [
                InlineKeyboardButton("🔒 حماية", callback_data="lockdd"),
                InlineKeyboardButton("🔊 إدارة", callback_data="abimnn"),
                InlineKeyboardButton("🎵 موسيقى", callback_data="playyy"),
            ],
            [
                InlineKeyboardButton("🔍 بحث", callback_data="deeev"),
            ],
            [
                InlineKeyboardButton("🎮 ألعاب", callback_data="gamess"),
                InlineKeyboardButton("✨ للمطور مميزة", callback_data="extra_cmds"),
            ],
            [        
                InlineKeyboardButton("🖇️ مميزة ", callback_data="cmdds2"),
            ],
        ]
    )
    
    await edit_message_with_retry(query, text, reply_markup)



@app.on_callback_query(filters.regex("playyy"), group=14)
async def playyy(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b>🎵 أوامر التشغيل في الجروب والقنوات:

• شغل (مع الاسم او رد)
• فيديو (للبث او عادي)
• بث مباشر (رابط او اسم)
• ايقاف (لايقاف الاغنيه)
• وقف (لايقاف مؤقت)
• تخطي (لاغنيه التالية)
• كمل (لاكمال المؤقت)
• قدم (مع عدد ثواني)
• رجوع (مع عدد ثواني)
• تكرار (مع عدد المرات)
• مين في الكول
• فتح الكول (لفتح محادثه)
• قفل الكول (لقفل محادثه<blockquote>)
⇜تنويه: جميع الاوامر تعمل باللغه الانجليزيه أيضاً</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)

@app.on_callback_query(filters.regex("lockdd"), group=120517665581)
async def lockdd(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b><u>🔒 أوامر القفل والفتح للحماية:</u>\n
• قفل و فتح (الدردشة)
• قفل و فتح (التوجيه)
• قفل و فتح (الصور)
• قفل و فتح (الفيديو)
• قفل و فتح (الميديا)
• قفل و فتح (الملصقات)
• قفل و فتح (الكلايش)
• قفل و فتح (السب)
• قفل و فتح (التعديل)
• قفل و فتح (التكرار)
• قفل و فتح (الروابط)
• قفل و فتح (المنشن)
• قفل و فتح (الاشعارات)
• قفل و فتح (البوتات)
• قفل و فتح (الاضافه)
• قفل و فتح (الاوامر)
• قفل و فتح (الملفات)
• قفل و فتح (الدعوة)
• قفل و فتح (التثبيت)
• قفل و فتح (الصوتيات)
• قفل و فتح (الريكورد)
• قفل و فتح (القنوات)
• قفل و فتح (العربيه)
• قفل و فتح (الانجليزيه)
• قفل و فتح (الهنديه)
• قفل و فتح (الفارسية)
• قفل و فتح (الارقام)
• قفل و فتح (التليثون)
• قفل و فتح (العبريه)
• قفل و فتح (الترحيب)
• قفل و فتح (الايدي)
• قفل و فتح (الكشف)
• قفل و فتح (صورتي)
• قفل و فتح (جمالي)
• قفل و فتح (بايو)
• قفل و فتح (اليوتيوب)
• قفل و فتح (التحميل)
• قفل و فتح (الازكار)
• قفل و فتح (النداء)
• قفل و فتح (التاك)
• قفل و فتح (المجموعة)
• قفل و فتح (الالعاب)
• قفل و فتح (الكل)
⇜تنويه: بعض الاوامر تعمل بـ(تفعيل و تعطيل)</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)

@app.on_callback_query(filters.regex("abimnn"), group=119340009986)
async def abinmnn(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b>🔊<u> أوامر الإدارة والتحكم:</u>

• تقييد (الغاء التقيد)
• حظر (الغاء الحظر)
• كتم (الغاء كتم)
• طرد البوتات
• كشف البوتات
• منع و الغاء منع (مع الكلمه)

<u>أوامر الرفع والتنزيل:</u>

• رفع مدير (معرف او رد)
• رفع مالك (معرف او رد)
• رفع ادمن (معرف او رد)
• رفع مطور (معرف او رد)
• رفع مشرف (معرف او رد)

<u>أوامر القوائم:</u>

• قائمة المكتومين: (المكتومين)
• قائمة المحظورين: (المحظورين)
• قائمة المقيدين: (المقيدين)
• قائمة المدربين: (المدراء)
• قائمة المطورين: (المطورين)
• قائمة المالكين: (المالكين)
• قائمة المشرفين: (المشرفين)
• قائمة الادمنيه: (الادمنيه)
• قائمة الممنوعات (الممنوعات 
)
<u>أوامر المسح:</u>

• مسح الادمنيه
• مسح المحظورين
• مسح المكتومين
• مسح المقيدين
• مسح المالكين
• مسح المطورين
• مسح الرتب</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)



@app.on_callback_query(filters.regex("gamess"), group=1445687746)
async def gamess(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b>🎮 <u>الألعاب والتسالي:</u>

• البنك
• لوخيروك
• كت
• تويت
• نكته
• اقتباس
• متحركه
• انصحني
• صراحه
• احكام
• الاعبين
• افلام
• مطربين
• اعلام
• مشاهير
• ترتيب
• النوادي
• قولي
• ويش يقول
• نسبه الغباء
• نسبه الحب
• نسبه الرجوله
• نسبه الانوثه
• وش يقول
• رو
• غنيلي
• مهنتي 
• هكرو
• قتل (معرف او رد)
• مح (معرف او رد)
• تف (معرف او رد)

• رفع كلب (معرف او رد)
• رفع حمار (معرف او رد)
• رفع بقره (معرف او رد)
• رفع قرد (معرف او رد)
• رفع تيس (معرف او رد)
• رفع خروف (معرف او رد)
• رفع خنزير (معرف او رد)
• رفع نسناس (معرف او رد)
• رفع رقاصه (معرف او رد)</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)

@app.on_callback_query(filters.regex("deeev"), group=777)
async def deeeeev(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """
<b>🔍 <u>أوامر البحث والمعلومات:</u>


• بحث (مع الاسم)
• يوتيوب (مع الاسم)
• يوت (مع الاسم)
• الايدي
• جمالي
• صورتي
• جروب
• صورني
• كشف
• صلاحياته 
• صلاحياتي
• لقبه
• زخرفه
• لقبي
• اضف رد
• حذف رد
• الردود
• اضف رد عام
• حذف رد عام
• الردود العام
• همسه (اهمس بالرد)
• تلجراف ميديا (فديو او صوره)
• استك (بالرد للاستيكر)
• تحويل لصوره (بالرد للاستيكر)
• تثبيت و الغاء التثبيت (بالرد)
• رابط (يجلب رابط المجموعه)
• مسح (بالرد عالرساله)
• تنظيف (ينظف دردشة كلها)
• فحص الجروب (يجلب معلوماتها)
• تفعيل بايو (لوضع ساعة بالبايو)
• تفعيل ساعه الحروب (لوضع ساعه للاسم)</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)
    
@app.on_callback_query(filters.regex("cmdds2"), group=777)
async def deeeeevcmdds2(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b><u>✨ الأوامر المميزة للمطور</u>

• الترويج
• تغير كليشة السورس
• تغير زر السورس
• تغير لوجو السورس
• حذف تخصيص السورس
• تغير رسالة استارت
• حذف رساله استارت
• تعطيل استارت
• تعطيل استارت

• اذاعه للجروبات
• اذاعه للقنوات
• اذاعه بالثبيت 
• اذاعه للمسخدمين

• الاشتراك الإجباري:
• تفعيل الاشتراك العام: 
• تعطيل الاشتراك العام: 
• تفعيل الاشتراك برايفت: 
• تعطيل الاشتراك برايفت: 
• اضف قناه الاشتراك للتشغيل: 
• تفعيل الاشتراك للتشغيل: 
• تعطيل الاشتراك للتشغيل: 
• قناة الاشتراك: 
• حذف قناة الاشتراك 
• فحص المساعد: 
• اضف الاسم الاول: 
• ازالة الاسم الاول: 
• تغير يوزر المساعد: 
• اضف بايو 
• ازالة بايو 
• اضف الاسم التاني 
• ازالة الاسم التاني 
• اضف صوره 
• ازالة صوره 
• ازالة كل الصور 
</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)
    
@app.on_callback_query(filters.regex("extra_cmds"), group=776557)
async def deeeeeextra_cmdsv(client, query: CallbackQuery):
    global user
    chat = query.message.chat
    get = await client.get_chat_member(chat.id, query.from_user.id)
    if query.from_user.id != user:
        await client.answer_callback_query(query.id, text="هييه مايمديك الامر ياروعه!!", show_alert=True)
        return

    await client.answer_callback_query(query.id)
    
    text = """<b>⛓️‍💥<u>اوامر خاصة بالمطور</u>\n
• رفع مطور 
• المطورين 
• غادر الجروبات 
• غادر القنوات 
• معلومات التنصيب 
• فحص البوت 
• سرعه البوت 
• تحديث البوت 
• تفعيل التواصل
• المجموعات 
• المستخدمين 
• احصائيات 
• تعطيل الميوزك عام
• تفعيل الميوزك عام
• تفعيل التحميل عام
• تعطيل التحميل عام
• تشغيل الساعة : للمساعد 
• ايقاف الساعة : للمساعد 
• تغير خط الساعه: للمساعد 
• تغير رمز الساعه : للمساعد 
• المساعد : لمعرفه مساعد يعمل 
• غادر الجروبات : المساعد 
• غادر القنوات : المساعد 
• اذاعه بتوجيه بالمساعد 
• اذاعه بالمساعد 
• تعين اسم البوت 
• تفعيل السجل 
• النسخه الاحتياطية:
• جلب نسخه للجروبات
• رفع نسخه للجروبات
• جلب نسخه للمستخدمين
• رفع نسخه للمستخدمين: 
• رفع نسخه للقنوات 
• جلب نسخه للقنوات</b>"""
    
    reply_markup = InlineKeyboardMarkup(
        [[InlineKeyboardButton("˹➻ٰ", callback_data="Musicvega")]]
    )
    
    await edit_message_with_retry(query, text, reply_markup)
    
    
    
    


# قائمة الكلمات الممنوعة (سيتم تخزينها لكل مجموعة)
banned_words = {}
# قاموس لتتبع المستخدمين الذين يطلبون إضافة كلمة ممنوعة
waiting_for_word = {}

@app.on_message(filters.command("منع", "") & filters.group, group=55555557)
async def ban_word_command(client, message):
    # التحقق من صلاحيات المستخدم (أدمن أو أعلى)
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or 
        is_owner(None, None, message) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        
        # طلب إدخال الكلمة
        await message.reply_text("📝 يرجى إرسال الكلمة التي تريد منعها")
        # تخزين معلومات المستخدم الذي يطلب إضافة كلمة
        waiting_for_word[message.from_user.id] = {
            "chat_id": message.chat.id,
            "type": "ban"
        }
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("الغاء منع", "") & filters.group, group=54333333)
async def unban_word_command(client, message):
    # التحقق من صلاحيات المستخدم (أدمن أو أعلى)
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or 
        is_owner(None, None, message) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        
        # طلب إدخال الكلمة
        await message.reply_text("📝 يرجى إرسال الكلمة التي تريد إلغاء منعها")
        # تخزين معلومات المستخدم الذي يطلب إزالة كلمة
        waiting_for_word[message.from_user.id] = {
            "chat_id": message.chat.id,
            "type": "unban"
        }
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("قائمة المنع", "") & filters.group, group=5372)
async def banned_words_list(client, message):
    chat_id = str(message.chat.id)
    
    if chat_id in banned_words and banned_words[chat_id]:
        words_list = "\n".join([f"• {word}" for word in banned_words[chat_id]])
        await message.reply_text(f"📜 قائمة الكلمات الممنوعة:\n{words_list}")
    else:
        await message.reply_text("📭 لا توجد كلمات ممنوعة في هذه المجموعة")

@app.on_message(filters.group & filters.text, group=33)
async def process_word_input(client, message):
    user_id = message.from_user.id
    if user_id in waiting_for_word:
        chat_id = waiting_for_word[user_id]["chat_id"]
        word = message.text.strip().lower()
        
        # إضافة أو إزالة الكلمة حسب نوع الطلب
        if waiting_for_word[user_id]["type"] == "ban":
            # إنشاء قائمة الكلمات الممنوعة للمجموعة إذا لم تكن موجودة
            if str(chat_id) not in banned_words:
                banned_words[str(chat_id)] = []
            
            # إضافة الكلمة إلى القائمة إذا لم تكن موجودة بالفعل
            if word not in banned_words[str(chat_id)]:
                banned_words[str(chat_id)].append(word)
                await message.reply_text(f"✅ تم منع الكلمة: {word}\nسيتم حذفها إذا تم إرسالها من قبل الأعضاء")
            else:
                await message.reply_text("⚠️ هذه الكلمة ممنوعة بالفعل!")
        else:
            # إزالة الكلمة من القائمة
            if str(chat_id) in banned_words and word in banned_words[str(chat_id)]:
                banned_words[str(chat_id)].remove(word)
                await message.reply_text(f"✅ تم إلغاء منع الكلمة: {word}")
            else:
                await message.reply_text("⚠️ هذه الكلمة غير ممنوعة أصلاً!")
        
        # إزالة المستخدم من قائمة الانتظار
        del waiting_for_word[user_id]
    else:
        # التحقق من الكلمات الممنوعة للرسائل العادية
        await check_banned_words(client, message)




async def check_banned_words(client, message):
    if not message.text:
        return
    
    chat_id = str(message.chat.id)
    if chat_id in banned_words and banned_words[chat_id]:
        message_text = message.text.lower()
        user_id = message.from_user.id
        
        # التحقق من صلاحيات المستخدم
        try:
            member = await client.get_chat_member(chat_id, user_id)
            if (member.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or
                is_owner(None, None, message) or
                is_moteerr(user_id) or
                is_mutaw(user_id) or
                is_malkeen(user_id) or
                is_admann(user_id)):
                return  # لا تقم بأي شيء إذا كان المستخدم من الرتب العليا
        except Exception as e:
            print(f"Error getting chat member: {e}")
            return
        
        # التحقق من وجود أي كلمة ممنوعة في الرسالة
        for word in banned_words[chat_id]:
            if word in message_text:
                # حذف الرسالة إذا احتوت على كلمة ممنوعة
                try:
                    await message.delete()
                    await client.send_message(
                        chat_id=message.chat.id,
                        text=f"「  {message.from_user.mention}  」\nهذه الكلمة ممنوعة!\n༄",
                        reply_to_message_id=message.id
                    )
                except Exception as e:
                    print(f"Error deleting message: {e}")
                break


@app.on_message(filters.command("قفل التكرار", "") & filters.group, group=27)
async def lock_repeat(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):    
        if not locks.repeat_locked:
            locks.repeat_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت التكرار\n༄")
        else:
            await message.reply_text("🔒 التكرار مقفل بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح التكرار", "") & filters.group, group=27)
async def unlock_repeat(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if locks.repeat_locked:
            locks.repeat_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت التكرار\n༄")
        else:
            await message.reply_text("🔓 التكرار مفتوح بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

# متغيرات لتتبع التكرار
user_message_history = {}  # {chat_id: {user_id: [messages]}}

async def check_repeat(chat_id, user_id, text):
    # تهيئة التاريخ إذا لم يكن موجوداً
    if chat_id not in user_message_history:
        user_message_history[chat_id] = {}
    if user_id not in user_message_history[chat_id]:
        user_message_history[chat_id][user_id] = []
    
    # إضافة الرسالة الجديدة
    user_message_history[chat_id][user_id].append(text)
    
    # الحفاظ على آخر 5 رسائل فقط
    if len(user_message_history[chat_id][user_id]) > 5:
        user_message_history[chat_id][user_id] = user_message_history[chat_id][user_id][-5:]
    
    # التحقق من التكرار
    if len(user_message_history[chat_id][user_id]) >= 3:
        last_three = user_message_history[chat_id][user_id][-3:]
        if all(msg == text for msg in last_three):
            return True
    return False

@app.on_message(filters.group & ~filters.service, group=32)
async def handle_repeat(client, message):
    try:
        if not message.from_user or not message.text:
            return
            
        chat_id = message.chat.id
        user_id = message.from_user.id
        locks = get_chat_locks(chat_id)
        
        if locks.repeat_locked:
            member = await client.get_chat_member(chat_id, user_id)
            if not (member.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or
                   is_owner(None, None, message) or
                   is_moteerr(user_id) or
                   is_mutaw(user_id) or
                   is_malkeen(user_id) or
                   is_admann(user_id)):
                
                is_repeated = await check_repeat(chat_id, user_id, message.text)
                if is_repeated:
                    await message.delete()
                    warning_msg = await client.send_message(
                        chat_id=chat_id,
                        text=f"「  {message.from_user.mention}  」\nممنوع تكرار الرسائل هنا!\n༄"
                    )
                    
    except Exception as e:
        print(f"حدث خطأ أثناء معالجة التكرار: {e}")

@app.on_message(filters.command("قفل البوتات", "") & filters.group, group=25)
async def lock_bots(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if not locks.bots_locked:
            locks.bots_locked = True
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت البوتات\n༄")
        else:
            await message.reply_text("🔒 البوتات مقفلة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح البوتات", "") & filters.group, group=25)
async def unlock_bots(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if locks.bots_locked:
            locks.bots_locked = False
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر فتحت البوتات\n༄")
        else:
            await message.reply_text("🔓 البوتات مفتوحة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_chat_member_updated()
async def handle_new_bot(client, chat_member_updated):
    try:
        chat_id = chat_member_updated.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.bots_locked and chat_member_updated.new_chat_member.user.is_bot:
            # طرد البوت الجديد
            await client.ban_chat_member(
                chat_id=chat_id,
                user_id=chat_member_updated.new_chat_member.user.id
            )
            await client.send_message(
                chat_id=chat_id,
                text=f"❌ تم طرد البوت [{chat_member_updated.new_chat_member.user.first_name}](tg://user?id={chat_member_updated.new_chat_member.user.id}) بسبب تفعيل قفل البوتات"
            )
    except Exception as e:
        print(f"حدث خطأ أثناء معالجة البوت الجديد: {e}")


@app.on_message(filters.command("قفل التعديل", "") & filters.group, group=23)
async def lock_edit(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
        if not locks.edit_locked:
            locks.edit_locked = True
            await message.reply_text(f"⇜من「 {message.from_user.mention} 」\n⇜ابشر قفلت التعديل\n༄")
        else:
            await message.reply_text("🔒 التعديل مقفل بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح التعديل", "") & filters.group, group=23)
async def unlock_edit(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if locks.edit_locked:
            locks.edit_locked = False
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر فتحت التعديل\n༄")
        else:
            await message.reply_text("🔓 التعديل مفتوح بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_edited_message(filters.group, group=30)
async def handle_edited_messages(client, edited_message):
    try:
        chat_id = edited_message.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.edit_locked and edited_message.from_user:
            member = await client.get_chat_member(chat_id, edited_message.from_user.id)
            if not (member.status in [ChatMemberStatus.OWNER] or
                   is_owner(None, None, edited_message) or
                   is_moteerr(edited_message.from_user.id) or 
                   is_mutaw(edited_message.from_user.id) or
                   is_malkeen(edited_message.from_user.id) or
                   is_admann(edited_message.from_user.id)):
                await edited_message.delete()
                await client.send_message(
                    chat_id=chat_id,
                    text=f"「  {edited_message.from_user.mention} 」\n ممنوع تعديل الرسائل هنا!\n༄"
                )
    except Exception as e:
        print(f"حدث خطأ أثناء معالجة الرسالة المعدلة: {e}")



@app.on_message(filters.command("قفل الاشعارات", "") & filters.group, group=31)
async def lock_notifications(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or
        is_moteerr(message.from_user.id) or  
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if not locks.notifications_locked:
            locks.notifications_locked = True
            await client.set_chat_permissions(
                chat_id=chat_id,
                permissions=ChatPermissions(
                    can_send_messages=True,
                    can_send_media_messages=True,
                    can_send_polls=True,
                    can_send_other_messages=True,
                    can_add_web_page_previews=True,
                    can_change_info=False,
                    can_invite_users=False,
                    can_pin_messages=False
                )
            )
            await message.reply_text(f"⇜من「  {message.from_user.mention} 」\n⇜ابشر قفلت الاشعارات\n༄")
        else:
            await message.reply_text("🔒 الإشعارات مقفلة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح الاشعارات", "") & filters.group, group=31)
async def unlock_notifications(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if locks.notifications_locked:
            locks.notifications_locked = False
            await client.set_chat_permissions(
                chat_id=chat_id,
                permissions=ChatPermissions(
                    can_send_messages=True,
                    can_send_media_messages=True,
                    can_send_polls=True,
                    can_send_other_messages=True,
                    can_add_web_page_previews=True,
                    can_change_info=True,
                    can_invite_users=True,
                    can_pin_messages=True
                )
            )
            await message.reply_text(f"⇜من「 {message.from_user.mention}\n⇜ابشر فتحت الاشعارات\n༄")
        else:
            await message.reply_text("🔓 الإشعارات مفتوحة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("قفل الاضافه", "") & filters.group, group=22)
async def lock_add(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if not locks.add_locked:
            locks.add_locked = True
            await client.set_chat_permissions(
                chat_id=chat_id,
                permissions=ChatPermissions(
                    can_invite_users=False
                )
            )
            await message.reply_text(f"⇜من「  {message.from_user.mention}\n⇜ابشر قفلت الاضافه\n༄")
        else:
            await message.reply_text("🔒 الاضافه مقفلة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_message(filters.command("فتح الاضافه", "") & filters.group, group=22)
async def unlock_add(client, message):
    chat_id = message.chat.id
    locks = get_chat_locks(chat_id)
    
    get = await client.get_chat_member(message.chat.id, message.from_user.id)
    if (get.status in [ChatMemberStatus.OWNER] or 
        is_owner(None, None, message) or 
        is_moteerr(message.from_user.id) or 
        is_mutaw(message.from_user.id) or 
        is_malkeen(message.from_user.id) or 
        is_admann(message.from_user.id)):
    
        if locks.add_locked:
            locks.add_locked = False
            await client.set_chat_permissions(
                chat_id=chat_id,
                permissions=ChatPermissions(
                    can_invite_users=True
                )
            )
            await message.reply_text(f"⇜من「  {message.from_user.mention}\n⇜ابشر فتحت الاضافه\n༄")
        else:
            await message.reply_text("🔓 الاضافه مفتوحة بالفعل!")
    else:
        await message.reply_text("هذا الأمر يخص ❪ الأدمن وفوق ❫ بس")

@app.on_chat_member_updated()
async def handle_new_member(client, chat_member_updated):
    try:
        chat_id = chat_member_updated.chat.id
        locks = get_chat_locks(chat_id)
        
        if locks.add_locked and chat_member_updated.new_chat_member:
            # التحقق إذا كانت الإضافة بواسطة عضو عادي وليس أدمن أو مالك
            adder = chat_member_updated.invited_by
            if adder:
                member = await client.get_chat_member(chat_id, adder.id)
                if not (member.status in [ChatMemberStatus.OWNER, ChatMemberStatus.ADMINISTRATOR] or
                       is_owner(None, None, chat_member_updated) or
                       is_moteerr(adder.id) or 
                       is_mutaw(adder.id) or
                       is_malkeen(adder.id) or
                       is_admann(adder.id)):
                    # طرد العضو المضاف
                    await client.ban_chat_member(
                        chat_id=chat_id,
                        user_id=chat_member_updated.new_chat_member.user.id
                    )
                    # إرسال تحذير
                    await client.send_message(
                        chat_id=chat_id,
                        text=f"❌ تم طرد {chat_member_updated.new_chat_member.user.mention} بسبب قفل الإضافة\nالمضيف: {adder.mention}"
                    )
    except Exception as e:
        print(f"حدث خطأ أثناء معالجة العضو الجديد: {e}")




     